@*// *********************************************************************************************************
    //  View Name                : LicenseSecurityDeposit
    //  Desciption               : Security Deposit Amount Detail
    //  Created By               : Akshaya Dalei
    //  Created On               : 24 July 2021
    // ********************************************************************************************************
*@

@{
    ViewBag.Title = "Form 7";
    Layout = "~/Views/Shared/_CMSLayout.cshtml";
}

@model userregistrationEF.LicenseApplication
<style>
    /*  bhoechie tab */
    div.bhoechie-tab-container {
        z-index: 10;
        background-color: #ffffff;
        padding: 0 !important;
        border-radius: 4px;
        -moz-border-radius: 4px;
        border: 1px solid #ddd;
        margin-top: 20px;
        margin-left: 0px;
        margin-bottom: 20px;
        -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
        box-shadow: 0 6px 12px rgba(0,0,0,.175);
        -moz-box-shadow: 0 6px 12px rgba(0,0,0,.175);
        background-clip: padding-box;
        opacity: 0.97;
        filter: alpha(opacity=97);
    }

    div.bhoechie-tab-menu {
        padding-right: 0;
        padding-left: 0;
        padding-bottom: 0;
    }

        div.bhoechie-tab-menu div.list-group {
            margin-bottom: 0;
        }

            div.bhoechie-tab-menu div.list-group > a {
                margin-bottom: 0;
            }

                div.bhoechie-tab-menu div.list-group > a .glyphicon,
                div.bhoechie-tab-menu div.list-group > a .fa {
                    color: #5A55A3;
                }

                div.bhoechie-tab-menu div.list-group > a:first-child {
                    border-top-right-radius: 0;
                    -moz-border-top-right-radius: 0;
                }

                div.bhoechie-tab-menu div.list-group > a:last-child {
                    border-bottom-right-radius: 0;
                    -moz-border-bottom-right-radius: 0;
                }

                div.bhoechie-tab-menu div.list-group > a.active,
                div.bhoechie-tab-menu div.list-group > a.active .glyphicon,
                div.bhoechie-tab-menu div.list-group > a.active .fa {
                    background-color: #5A55A3;
                    color: #ffffff;
                }

                    div.bhoechie-tab-menu div.list-group > a.active:after {
                        content: '';
                        position: absolute;
                        left: 100%;
                        top: 50%;
                        margin-top: -13px;
                        border-left: 0;
                        border-bottom: 13px solid transparent;
                        border-top: 13px solid transparent;
                        border-left: 10px solid #5A55A3;
                    }

    div.bhoechie-tab-content {
        background-color: #ffffff;
        /* border: 1px solid #eeeeee; */
        padding-left: 20px;
        padding-top: 10px;
    }

    div.bhoechie-tab div.bhoechie-tab-content:not(.active) {
        display: none;
    }
</style>
<section class="wrapper main-wrapper row">
    <div class="col-12">
        @Html.Partial("_CMSnavigation")
        <!-- MAIN CONTENT AREA STARTS -->
        <div class="row">
            <div class="col-12">
                <div class="main-tab">
                    <ul class="nav nav-tabs">
                        <li class="nav-item">
                            <a class="nav-link active" href="javascript:void(0)">
                                Security Fees Payment Information
                            </a>
                        </li>
                    </ul>
                    @Html.Partial("_CMSutil")
                </div>

                <section class="box form-container">
                    <div class="content-body">
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="table-responsive" id="viewtable">


                                    @using (Html.BeginForm("LicenseSecurityDeposit", "LicenseApplication", FormMethod.Post, new { id = "__AntiForgeryForm", @enctype = "multipart/form-data" }))
                                    {
                                        @Html.AntiForgeryToken()
                                        @Html.HiddenFor(model => model.LicenseAppId)
                                        @Html.HiddenFor(model => model.SecurityAmount)
                                        @Html.HiddenFor(model => model.PaymentBank)
                                        @Html.HiddenFor(model => model.PaymentMode)
                                        @Html.Hidden("PaymentMode")
                                        @Html.Hidden("PaymentBank")
                                        @Html.Hidden("Pmode")
                                        @Html.Hidden("NetBanking_mode")

                                        <input type="hidden" value="@Model.TotalPayment" id="totalPayable" name="totalPayable">

                                        <div id="divMakePayment" style="height: 450px;">
                                            <div class="row">
                                                <div class="col-md-1"></div>
                                                <div class="col-md-11">
                                                    <div class="row">
                                                        <div class="col-xs-12">
                                                            <div class="col-md-offset-4 col-md-8 default-form-control-style">
                                                                <span class="lead">
                                                                    Security Deposit Amount Details
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>



                                                    <div class="col-lg-12 col-md-12 col-xs-12">
                                                        <div class="row" style="visibility: hidden; display: none;">
                                                            <div class="col-xs-12">
                                                                <div class="col-md-7 default-form-control-style">
                                                                    @(Html.Label("TransactionalID"))
                                                                </div>
                                                                <div class="col-md-5 default-form-control-style">

                                                                    <label>@Model.LicenseAppId </label>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <hr style="margin-top: 0px;" />
                                                        <div class="row">
                                                            <div class="col-lg-6 col-md-6 col-xs-12">
                                                                <div class="col-md-7 default-form-control-style">
                                                                    @(Html.Label("Applicant Name"))
                                                                </div>
                                                                <div class="col-md-5 default-form-control-style">

                                                                    <label>@Model.ApplicantName </label>

                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-lg-6 col-md-6 col-xs-12">
                                                                <div class="col-md-7 default-form-control-style">
                                                                    @(Html.Label("Storage Capacity"))
                                                                </div>
                                                                <div class="col-md-5 default-form-control-style">

                                                                    <label>@Model.StorageCapicity </label>

                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-lg-6 col-md-6 col-xs-12">
                                                                <div class="col-md-7 default-form-control-style">
                                                                    @(Html.Label("Total Payable Amount"))
                                                                </div>
                                                                <div class="col-md-5 default-form-control-style">

                                                                    <label>@Model.SecurityAmount </label>

                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>


                                                    <div class="row">
                                                        <div class="col-md-3">
                                                            <span>Payment Mode</span>
                                                        </div>
                                                        <hr />
                                                    </div>

                                                    @if (Model.ActiveStatus != "4")
                                                    {
                                                        if (Model.ChallanNumber == "ONLINE PAYMENT")
                                                        {
                                                            <div class="col-lg-6 col-md-4 col-xs-12">
                                                                <div class="row">
                                                                    <div class="col-xs-12">
                                                                        <div class="col-md-4 default-form-control-style">
                                                                            @(Html.Label("Payment Mode"))
                                                                        </div>
                                                                        <div class="col-md-8 default-form-control-style">
                                                                            @if (Model.ActiveStatus == "1")
                                                                            {
                                                                                @(Html.TextBoxFor(model => model.ChallanDate, new { @class = "form-control", @readonly = "readonly", @Value = "Online Payment Awaited" }))
                                                                            }
                                                                            else
                                                                            {
                                                                                @(Html.TextBoxFor(model => model.ChallanDate, new { @class = "form-control", @readonly = "readonly", @Value = "Online Payment" }))
                                                                            }
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-xs-12">
                                                                        <div class="col-md-4 default-form-control-style">
                                                                            @(Html.Label("Payment Date"))
                                                                        </div>
                                                                        <div class="col-md-8 default-form-control-style">
                                                                            @(Html.TextBoxFor(model => model.ChallanDate, new { @class = "form-control", @readonly = "readonly" }))
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        }
                                                        else
                                                        {
                                                            <div class="col-lg-6 col-md-4 col-xs-12">
                                                                <div class="row">
                                                                    <div class="col-xs-12">
                                                                        <div class="col-md-4 default-form-control-style">
                                                                            @(Html.Label("Challan Number"))
                                                                        </div>
                                                                        <div class="col-md-8 default-form-control-style">
                                                                            @(Html.TextBoxFor(model => model.ChallanNumber, new { @class = "form-control", @readonly = "readonly" }))
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-xs-12">
                                                                        <div class="col-md-4 default-form-control-style">
                                                                            @(Html.Label("Challan Date"))
                                                                        </div>
                                                                        <div class="col-md-8 default-form-control-style">
                                                                            @(Html.TextBoxFor(model => model.ChallanDate, new { @class = "form-control", @readonly = "readonly" }))
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-xs-12">
                                                                        <div class="col-md-4 default-form-control-style">
                                                                            @(Html.Label("Challan Copy"))
                                                                        </div>
                                                                        <div class="col-md-8 default-form-control-style">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        }
                                                    }
                                                    else
                                                    {
                                                        <div class="row">
                                                            <div class="col-xs-11">
                                                                <div class="col-lg-11 col-md-4 col-sm-12 col-xs-12 bhoechie-tab-container">
                                                                    <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 bhoechie-tab-menu">
                                                                        <div class="list-group">
                                                                            <a href="#" class="list-group-item active text-center" id="divOnlineOption">
                                                                                Online Payment
                                                                            </a>

                                                                        </div>
                                                                    </div>
                                                                    <div class="col-lg-9 col-md-9 col-sm-9 col-xs-9 bhoechie-tab">
                                                                        <!-- Online payment section -->
                                                                        <div class="bhoechie-tab-content active">

                                                                            <div class="row" id="divPaymentOptionOnline">
                                                                                <div class="col-lg-9 col-md-4 col-xs-12">
                                                                                    <div id="divOnlineChallanDetails">
                                                                                        <div class="col-xs-12">
                                                                                            <div class="col-md-4 default-form-control-style">
                                                                                                <img src="~/img/SBI.jpg" alt="SBI" style="width:100px;height:50px;" />
                                                                                                @if (Model.ActiveStatus == "4")
                                                                                                {
                                                                                                    <input name="BankSelection" type="radio" id="chkSBI" value="SBI" checked="checked" />
                                                                                                }
                                                                                            </div>
                                                                                            <div class="col-md-4 default-form-control-style" style="text-align: left;">
                                                                                                <img src="~/img/ICICI.png" alt="ICICI" style="width:100px;height:50px;" />
                                                                                                @if (Model.ActiveStatus == "4")
                                                                                                {
                                                                                                    <input name="BankSelection" type="radio" id="chkICICI" value="ICICI" />
                                                                                                }
                                                                                            </div>

                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="row" id="divPaymentOption" style="display: none">
                                                                                        <div class="col-lg-12 col-md-12 col-xs-12">
                                                                                            <div id="divOnline">
                                                                                                <div class="col-xs-12">
                                                                                                    <div class="col-md-4 default-form-control-style" style="text-align: left;">
                                                                                                        @(Html.Label("Net Banking"))
                                                                                                        <input name="ModeSelection" type="radio" value="NetBanking" checked="checked" />
                                                                                                    </div>
                                                                                                    <div class="col-md-4 default-form-control-style">
                                                                                                        @(Html.Label("NEFT/RTGS"))
                                                                                                        <input name="ModeSelection" type="radio" value="NEFT" />
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <!-- Offlineline payment section -->

                                                                    </div>
                                                                </div>
                                                                <br />
                                                            </div>
                                                        </div>
                                                    }

                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-offset-5 col-xs-7 col-md-7">
                                                    <div class="col-sm-12">
                                                        <input type="button" value="Back" id="btnBack" onclick="Oncancel();" class="btn  btn-sm btn-blue-alt" style="width: 85px;" />
                                                        <input type="button" onclick="return onMakePayment();" value="Payment" id="btnPayment" class="btn  btn-sm btn-blue-alt" style="width: 100px;" />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    }


                                </div>


                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>
</section>
@{if (TempData["AckMessage"] != null)
    {
        <script>
               alert('@ViewBag.msg');
        </script>
    }
}
<script>


    $("#chkICICI").click(function () {
        $("#divPaymentOption").show();
    });

    $("#chkHDFC").click(function () {
        $("#divPaymentOption").hide();
    });

    $("#chkSBI").click(function () {
        $("#divPaymentOption").hide();
    });

    $(document).ready(function () {
        $(document).ready(function () { loadNavigation('LicenseSecurityDeposit', 'ql', 'pl', 'tl', 'License', 'LicenseSecurityDeposit', ' '); });
        $(".sidebar-toggle").click();
        $("div.bhoechie-tab-menu>div.list-group>a").click(function (e) {
            e.preventDefault();
            $(this).siblings('a.active').removeClass("active");
            $(this).addClass("active");
            var index = $(this).index();
            $("div.bhoechie-tab>div.bhoechie-tab-content").removeClass("active");
            $("div.bhoechie-tab>div.bhoechie-tab-content").eq(index).addClass("active");

        });
    });

    function onMakePayment() {
        var isValid = 0;
        if ($("#divOnlineOption").hasClass("active") == true) {
            $("#PaymentMode").val(1); // set online payment mode

            var bank = $("input:radio[name='BankSelection']:checked").val();
            var mode = $("input:radio[name='ModeSelection']:checked").val();

            if (bank == "HDFC") {
                $("#PaymentBank").val("HDFC");
                if (confirm('Are you sure to make payment ?')) {
                    $("#__AntiForgeryForm").submit();
                }
            }
            else if (bank == "ICICI") {
                $("#PaymentBank").val("ICICI");
                if (mode == "NetBanking") {
                    $("#PaymentMode").val("NetBanking")
                    if (NetBanking == "Corporate") {
                        $("#NetBanking_mode").val("Corporate");
                        $("#__AntiForgeryForm").submit();
                    }
                    else if (NetBanking == "Retail") {
                        $("#NetBanking_mode").val("Retail");
                        $("#__AntiForgeryForm").submit();
                    }
                }
                else {
                    $("#PaymentMode").val("NEFT")
                    $("#__AntiForgeryForm").submit();
                }

            }
            else if (bank == "SBI") {

                $("#PaymentBank").val("SBI");
                if (confirm('Are you sure to make payment ?')) {
                    $("#__AntiForgeryForm").submit();
                }
            }
            else {

                alert("Please select bank to make payment !");
                return false;

            }
        }
        else {
            $("#PaymentMode").val(0); // set offline mode value
            if ($("#ChallanNumber").val()) {
                if ($("#ChallanDate").val()) {
                    if ($('input[name="ChallanCopyPath"]').val() != "") {
                        if (filesize < 2048000) {
                            if (confirm('Are you sure to make payment ?')) {
                                $("#__EUAntiForgeryForm").submit();
                            }
                        }
                        else {
                            alert("Please make sure your file is less than 2 MB!");
                            return false;
                        }
                    }
                    else {
                        alert("Please select file!");
                    }
                }
                else {
                    lert("Please enter Challan Date!");
                    $("#ChallanDate").focus();
                }
            }
            else {
                alert("Please enter Challan Number!");
                $("#ChallanNumber").focus();
            }
        }
    }

    function Oncancel() {
        window.location.href = "/Licensee/LicenseApplication/LicenseApprovalList";
    }
</script>